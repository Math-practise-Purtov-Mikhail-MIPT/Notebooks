# Решение задачи вероятности выигрыша матча

## Условие задачи

Две волейбольные команды играют в матче до трех побед. Вероятность того, что команда А выиграет партию, выиграв предыдущие \( k \) партий, равна
\[
p(k) = \frac{1}{2} - \frac{k}{4}.
\]
Необходимо определить вероятность того, что команда А выиграет матч, и вывести ответ, умноженный на 128.

## Модель игры

Матч моделируется состояниями, обозначаемыми тройкой \((i, j, s)\), где:
- \( i \) — число побед команды А,
- \( j \) — число побед команды B,
- \( s \) — текущая длина подряд выигранных партий команды А (принимает значения \(0\), \(1\) или \(2\)).

Переходы между состояниями происходят следующим образом:

- **При выигрыше партии**:
  - Вероятность выигрыша зависит от \( s \):
    \[
    p(s) = \frac{1}{2} - \frac{s}{4}.
    \]
  - Состояние переходит в \((i+1,\, j,\, s+1)\).

- **При проигрыше партии**:
  - Вероятность проигрыша:
    \[
    q(s) = 1 - p(s) = \frac{1}{2} + \frac{s}{4}.
    \]
  - Состояние переходит в \((i,\, j+1,\, 0)\) (серия выигрышей сбрасывается).

Матч завершается, когда достигается одно из состояний: \( i = 3 \) (победа команды А) или \( j = 3 \) (победа команды B).

## Рекуррентное соотношение

Обозначим \( P(i, j, s) \) — вероятность того, что команда А выиграет матч из состояния \((i, j, s)\). Для нетерминальных состояний имеем соотношение:
\[
P(i, j, s) = p(s) \, P(i+1, j, s+1) + q(s) \, P(i, j+1, 0).
\]

Граничные условия:
\[
P(3, j, s) = 1 \quad \text{(команда А выиграла матч)},
\]
\[
P(i, 3, s) = 0 \quad \text{(команда B выиграла матч)}.
\]

## Поэтапное вычисление

Ниже приводятся ключевые этапы вычислений:

1. **Финальные состояния (последняя партия):**

   - \((2, 2, 0)\):
     \[
     P(2, 2, 0) = p(0) \cdot 1 + q(0) \cdot 0 = \frac{1}{2}.
     \]
     
   - \((2, 2, 1)\):
     \[
     P(2, 2, 1) = p(1) \cdot 1 + q(1) \cdot 0 = \frac{1}{4}.
     \]
     
   - \((2, 2, 2)\):  
     При \( s = 2 \) действует \( p(2)=0 \), поэтому:
     \[
     P(2, 2, 2) = 0.
     \]

2. **Предпоследние состояния:**

   - \((2, 1, 2)\):  
     При \( s = 2 \) выиграть следующую партию невозможно (только переход при проигрыше), таким образом:
     \[
     P(2, 1, 2) = P(2, 2, 0) = \frac{1}{2}.
     \]
     
   - \((1, 2, 1)\):
     \[
     P(1, 2, 1) = p(1) \cdot P(2, 2, 2) + q(1) \cdot 0 = \frac{1}{4} \cdot 0 = 0.
     \]
     
   - \((1, 2, 0)\):
     \[
     P(1, 2, 0) = p(0) \cdot P(2, 2, 1) + q(0) \cdot 0
     = \frac{1}{2} \cdot \frac{1}{4} = \frac{1}{8}.
     \]
     
   - \((2, 1, 1)\):
     \[
     P(2, 1, 1) = p(1) \cdot 1 + q(1) \cdot P(2, 2, 0)
     = \frac{1}{4} + \frac{3}{4} \cdot \frac{1}{2}
     = \frac{1}{4} + \frac{3}{8} = \frac{5}{8}.
     \]
     
   - \((2, 1, 0)\):
     \[
     P(2, 1, 0) = p(0) \cdot 1 + q(0) \cdot P(2, 2, 0)
     = \frac{1}{2} + \frac{1}{2} \cdot \frac{1}{2}
     = \frac{1}{2} + \frac{1}{4} = \frac{3}{4}.
     \]
     
   - \((1, 1, 1)\):
     \[
     P(1, 1, 1) = p(1) \cdot P(2, 1, 2) + q(1) \cdot P(1, 2, 0)
     = \frac{1}{4} \cdot \frac{1}{2} + \frac{3}{4} \cdot \frac{1}{8}
     = \frac{1}{8} + \frac{3}{32} = \frac{7}{32}.
     \]
     
   - \((1, 1, 0)\):
     \[
     P(1, 1, 0) = p(0) \cdot P(2, 1, 1) + q(0) \cdot P(1, 2, 0)
     = \frac{1}{2} \cdot \frac{5}{8} + \frac{1}{2} \cdot \frac{1}{8}
     = \frac{5}{16} + \frac{1}{16} = \frac{3}{8}.
     \]
     
   - \((0, 2, 0)\):
     \[
     P(0, 2, 0) = p(0) \cdot P(1, 2, 1) + q(0) \cdot 0
     = \frac{1}{2} \cdot 0 = 0.
     \]
     
   - \((0, 1, 0)\):
     \[
     P(0, 1, 0) = p(0) \cdot P(1, 1, 1) + q(0) \cdot P(0, 2, 0)
     = \frac{1}{2} \cdot \frac{7}{32} + \frac{1}{2} \cdot 0
     = \frac{7}{64}.
     \]

3. **Исходное состояние:**

   - \((2, 0, 2)\):  
     При \( s = 2 \) выиграть партию нельзя, поэтому:
     \[
     P(2, 0, 2) = P(2, 1, 0) = \frac{3}{4}.
     \]
     
   - \((1, 0, 1)\):
     \[
     P(1, 0, 1) = p(1) \cdot P(2, 0, 2) + q(1) \cdot P(1, 1, 0)
     = \frac{1}{4} \cdot \frac{3}{4} + \frac{3}{4} \cdot \frac{3}{8}
     = \frac{3}{16} + \frac{9}{32} = \frac{15}{32}.
     \]
     
   - Наконец, для начального состояния \((0, 0, 0)\):
     \[
     P(0, 0, 0) = p(0) \cdot P(1, 0, 1) + q(0) \cdot P(0, 1, 0)
     = \frac{1}{2} \cdot \frac{15}{32} + \frac{1}{2} \cdot \frac{7}{64}
     = \frac{15}{64} + \frac{7}{128}
     = \frac{30}{128} + \frac{7}{128} = \frac{37}{128}.
     \]

Таким образом, вероятность того, что команда А выиграет матч, равна
\[
\frac{37}{128}.
\]

**Требуется ответ, умноженный на 128:**
\[
\frac{37}{128